---
title: OSCTF writeup
date: 2024-07-15 11:00:00 +0530
categories: [CTFs]
tags: [Web, Reversing, Misc, Forensics]
image: /images/osctf.png
---

> This CTF was organized by OSCTF team, Altered Security. 

> Our team managed to solve 47/60 challenges in this CTF.<br>
> :star: <span style="color: white;"><b>CREDITS:</b></span> <b>ckc9759, akaniii, noobobfuscator, ayussshhhh, nop_nop_0x90, .bitbasher</b>



<h2 id="WEB" style="color: #d9539d;">WEB</h2>

<h3 id="introspection" style="color: #faf5ab;">Introspection</h3>

![desc](/images/introspection_desc.png)

Moving to the challenge page -
![page](/images/introspection_page.png)
Checked the source code, opened the `script.js` file and got the flag
![source](/images/introspection_source.png)
![flag](/images/introspection_flag.png)


<h3 id="style-query-listing" style="color: #faf5ab;">Style Query Listing...?</h3>

![desc](/images/style_desc.png)

We are presented with a login page -
![login](/images/style_login.png)
The login page is vulnerable to SQL injection, i.e. we are able to login just by passing `' or '1'='1'-- -` in the username parameter and a random password in the password field.
In the profile page, on clicking on the `Show profile information` button, we are getting a fake flag.
![profile](/images/style_profile.png)
Just went to the `/admin` endpoint and got the flag.
![flag](/images/style_flag.png)


<h3 id="heads-or-tails" style="color: #faf5ab;">Heads or Tails?</h3>

![desc](/images/heads_desc.png)

Moving to the URL, it just said - 
![page](/images/heads_page.png)
And there was nothing is source code too, so the only thing that we can do here is directory bruteforcing.<br>
The hint in the challenge said - 

![hint](/images/heads_hint.png)

So, we can make a wordlist that includes words like - `head-flag`, `put-flag`, `get-admin`, `get-flag` etc..<br>
We can use a script like - 
```python
http_methods = ["get", "post", "put", "delete", "head", "connect", "options", "trace", "patch"]
ctf_words = [
    "flag", "admin", "login", "upload", "download", "register", "secret", "hidden",
    "password", "secure", "user", "account", "file", "directory", "config", "shell",
    "root", "backup", "data", "info", "access", "system", "control", "manage",
    "session", "token", "auth", "verify", "exploit", "vulnerability"
]


wordlist = [f"{method}-{word}" for method in http_methods for word in ctf_words]


with open("wordlist.txt", "w") as f:
    for entry in wordlist:
        f.write(entry + "\n")
```
Now, we can bruteforce using the generated wordlist, but it actually didn't work with normal GET requests, as the challenge name says - `Heads or Tails?` which might be pointing towards making a HEAD request. <br>
On bruteforcing with HEAD requests, got the flag at `/get-flag` endpoint
or, you can just make a little guess, and make a curl request to that endpoint 
![flag](/images/heads_flag.png)


<h3 id="indoor-webapp" style="color: #faf5ab;">Indoor WebApp</h3>

![desc](/images/indoor_desc.png)

Moving to the challenge page -
![page](/images/indoor_page.png)
We can see, that it is using the `user_id` parameter to load the profile. On changing the `user_id` to 2, got the flag.
![flag](/images/indoor_flag.png)


<h3 id="action notes" style="color: #faf5ab;">Action Notes</h3>

![desc](/images/action_desc.png)

Again a kind of guessy challenge.
Moving to the challenge page, we have `register` and `login` option. I simply registered and logged in using those credentials.
![page](/images/action_page.png)
![register](/images/action_register.png)
![login](/images/action_login.png)
![login](/images/action_notes.png)
Tested the `Add Note` feature, but didn't found anything interesting, and also doing directory bruteforcing, didn't give any interesting results as such.<br>
But after doing login bruteforcing, considering the username as `admin` got a valid password, and on logging in using those credentials, got the flag.
![password](/images/action_fuzzing.png)
![flag](/images/action_flag.png)



## FORENSICS
{: style="color: #d9539d;" id="forensics"}

### qRc0dE
{: sytle="color: #faf5ab;" id="qrcode"}

![desc](/images/qrcode_desc.png)

We are given a QR code -

![qrcode](/images/qrcode_code.jpg)

Now, we can use [this tool](https://merri.cx/qrazybox/) to manually build the QR code.<br>
Here are the steps - 
![blank](/images/qrcode_blank.png)
And then we can load the image we are given, as sample. Now, we first need to set the correct version, Error correction level and Mask Pattern.<br> We can check them one by one, and compare that with the given QR code. In this case, the version was 3, ECC level L, and Mask Pattern 3 
![qrcode](/images/qrcode_1.png)
Now, we can manually fill the pixels
![pixels](/images/qrcode_2.png)
After that, on extracting QR code information, still didn't got the complete and correct flag. Used `Reed-Solomon Decoder` 

![reed](/images/qrcode_3.png)
![not_flag](/images/qrcode_4.png)

After doing some corrections in the flag, this flag - `OSCTF{r3c0v3R_qR_C0de_1s_s0_fUn}` worked.



<h2 id="REVERSING" style="color: #d9539d;">REVERSING</h2>

### Avengers Assemble
{: style="color: #faf5ab;" id="avengers-assemble"}

![desc](/images/avengers_desc.png)

We are given a file - `code.asm`. Contents of the file -
```nasm
asm
extern printf
extern scanf

section .data
        fmt: db "%ld",0
        output: db "Correct",10,0
        out: db "Not Correct",10,0
        inp1: db "Input 1st number:",0
        inp2: db "Input 2nd number:",0
        inp3: db "Input 3rd number:",0

section .text
        global main
 
        main:
        push ebp
        mov ebp,esp
        sub esp,0x20
 
        push inp1
        call printf
        lea eax,[ebp-0x4]
        push eax
        push fmt
        call scanf

        push inp2
        call printf
        lea eax,[ebp-0xc]
        push eax
        push fmt
        call scanf

        push inp3
        call printf
        lea eax,[ebp-0x14]
        push eax
        push fmt
        call scanf

        mov ebx, DWORD[ebp-0xc]
        add ebx, DWORD[ebp-0x4]
        cmp ebx,0xdeadbeef
        jne N

        cmp DWORD[ebp-0x4], 0x6f56df65
        jg N

        cmp DWORD[ebp-0xc], 0x6f56df8d
        jg N
        cmp DWORD[ebp-0xc], 0x6f56df8d
        jl N

        mov ecx, DWORD[ebp-0x14]
        mov ebx, DWORD[ebp-0xc]
        xor ecx, ebx
        cmp ecx, 2103609845
        jne N
        jmp O

        N:
        push out
        call printf
        leave
        ret

        O:
        push output
        call printf

        leave
        ret
```
So, the above assembly code, is doing the following checks -
```plaintext
input1 + input2 == 0xdeadbeef
input1 <= 0x6f56df65
input2 == 0x6f56df8d
input3 ^ input2 == 2103609845
```
We have the value of input2, so we can easily get the value of input1 and input3
![input](/images/avengers_input.png)
So, the flag would be - `OSCTF{1867964258_1867964301_1867964301}`


### Gophers Language
{: style="color: #faf5ab;" id="gophers-language"}

![desc](/images/gopher_desc.png)

We are given a `main.exe` file.<br>
Don't know, whether it was intended or not, but got the flag, just by doing strings and grepping for the flag.
![flag](/images/gopher_flag.png)

### Another Python Game
{: style="color: #faf5ab;" id="another-python-game"}

![desc](/images/another_desc.png)

Access the challenge file [here](https://github.com/anishkumarroy/OSCTF_Files/blob/master/rev/Another%20Python%20Game/source.exe).<br>
We are given two files. Opened `source.exe` in Ghidra, there were a lot of functions. On looking at the strings, found that it the EXE is packed using pyinstaller. 
![pyinstaller](/images/another_pyinstaller.png)
If we search the web to unpack the EXE - 
![results](/images/another_results.png)
So, we can use the tool `pyinstxtractor` to extract the python code from the EXE
![unpack](/images/another_unpack.png)
We can see, that it says possible entry point to be `source.pyc` file. Now, source.pyc is a Python compiled file, so we can grep for the flag, or we can also decompile it using `uncompyle6`, but before that you need to install it using `pip install uncompyle6`
![grep](/images/another_grep.png)
Using `uncompyle6`
![uncompile](/images/another_uncompile.png)
![flag](/images/another_flag.png)






